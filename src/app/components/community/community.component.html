<div class="community-container">

    <!-- Filters Bar (Top) -->
    <div class="filter-bar">
        <div class="filter-item">
            <label>Activity Being Done</label>
            <div class="select-wrapper">
                <select [(ngModel)]="selectedActivity" (change)="applyFilters()">
                    <option *ngFor="let act of activities" [value]="act">{{ act }}</option>
                </select>
            </div>
        </div>
        <div class="filter-item">
            <label>Content Created</label>
            <div class="select-wrapper">
                <select [(ngModel)]="selectedContent" (change)="applyFilters()">
                    <option *ngFor="let type of contentTypes" [value]="type">{{ type }}</option>
                </select>
            </div>
        </div>
    </div>

    <!-- Cards Grid -->
    <div class="cards-grid">
        <div class="plan-card" *ngFor="let plan of filteredPlans" (click)="openPlan(plan.id)">

            <!-- Header Strip -->
            <div class="card-header">
                <span class="left-stat">{{ plan.goal_amount | number }} {{ plan.goal_unit }}</span>
                <span class="right-stat">{{ plan.progress_percent }}% Done</span>
            </div>

            <!-- Graph Area -->
            <div class="card-graph">
                <svg viewBox="0 0 280 60" preserveAspectRatio="none">
                    <!-- Sparkline -->
                    <path [attr.d]="getSparklinePath(plan.graph_data)" fill="none" stroke="#7dd3fc" stroke-width="1.5"
                        vector-effect="non-scaling-stroke" />

                    <!-- Hover Tooltip Hint (Using Title for simplicity) -->
                    <title>Target: {{plan.goal_amount}} | Done: {{plan.progress_percent}}%</title>
                </svg>
            </div>

            <!-- Footer Info -->
            <div class="card-footer">
                <div class="plan-name">{{ plan.title }}</div>
                <div class="author-info">{{ plan.content_type }} by {{ plan.creator_username }}</div>
            </div>
        </div>

        <!-- Empty State -->
        <div class="empty-state" *ngIf="filteredPlans.length === 0">
            <p>No plans found matching your filters.</p>
        </div>
    </div>
</div>